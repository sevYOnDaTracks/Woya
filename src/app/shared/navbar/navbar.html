<nav class="fixed top-0 left-0 w-full z-[9999] bg-[#FFF7EB] shadow-md p-4 md:px-16 flex md:p-4 justify-between items-center">

  <h1 class="text-3xl font-extrabold text-[#FF7A00] tracking-tight">
    <a routerLink="/">Woya!</a>
  </h1>

  <!-- ✅ Desktop -->
  <div class="hidden md:flex items-center gap-6">

    <a routerLink="/"
       routerLinkActive="active"
       [routerLinkActiveOptions]="{ exact: true }"
       class="menu-item">
      Accueil
    </a>

    <a routerLink="/services"
       routerLinkActive="active"
       class="menu-item">
      Services
    </a>

    <!-- Si NON connecté -->
    <button *ngIf="!(auth.user$ | async)"
     routerLink="/login"
      class="px-4 py-2 border border-[#FF7A00] text-[#FF7A00] rounded-xl text-sm hover:bg-[#FF7A00] hover:text-white transition">
      Se connecter
    </button>

        <button *ngIf="!(auth.user$ | async)"
      routerLink="/register"
      class="px-4 py-2 border border-[#FF7A00] text-[#FF7A00] rounded-xl text-sm hover:bg-[#FF7A00] hover:text-white transition">
      S'inscrire
    </button>

    <!-- Si connecté -->
    <ng-container *ngIf="auth.user$ | async as user">
      <!--
      <a routerLink="/mes-services"
         routerLinkActive="active"
         class="menu-item">
        Mes services
      </a>
      -->

      <a routerLink="/mes-services"
         routerLinkActive="active"
         class="menu-item">
        Mes services
      </a>

      <a routerLink="/messagerie"
         aria-label="Messagerie"
         routerLinkActive="active"
         class="menu-item inline-flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 7.5A2.5 2.5 0 0 1 5.5 5h13A2.5 2.5 0 0 1 21 7.5v9a2.5 2.5 0 0 1-2.5 2.5h-13A2.5 2.5 0 0 1 3 16.5v-9Z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="m3 8 8.4 6.3a1 1 0 0 0 1.2 0L21 8" />
        </svg>
        <span *ngIf="unreadCount > 0"
              class="ml-1 inline-flex items-center justify-center text-xs font-bold text-white bg-red-500 rounded-full min-w-[1.5rem] px-2 py-0.5 leading-none">
          {{ unreadCount > 10 ? '10+' : unreadCount }}
        </span>
      </a>

      <a routerLink="/services/new"
         class="px-4 py-2 bg-[#FF7A00] text-white rounded-xl text-sm hover:bg-[#e66d00] transition">
        Publier un service
      </a>

      <div class="relative user-menu" (click)="$event.stopPropagation()">
        <button type="button"
                (click)="toggleUserMenu()"
                class="flex items-center gap-2 px-3 py-2 rounded-xl border border-transparent hover:border-[#FFE0BF] transition">
          <img [src]="user.photoURL || 'assets/icone.png'" class="w-8 h-8 rounded-full object-cover border">
          <div class="flex items-center gap-1">
            <span class="font-semibold text-sm text-[#1A1A1A]">{{ user.firstname }}</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </div>
        </button>

        <div *ngIf="userMenuOpen"
             class="absolute right-0 mt-3 w-52 bg-white rounded-2xl border border-[#FFE0BF] shadow-lg py-2">
          <a routerLink="/mon-compte"
             routerLinkActive="active"
             (click)="closeUserMenu()"
             class="block px-4 py-2 text-sm text-gray-700 hover:bg-[#FFF4E6] rounded-xl mx-2">
            Mon compte
          </a>
          <a routerLink="/mes-services"
             routerLinkActive="active"
             (click)="closeUserMenu()"
             class="block px-4 py-2 text-sm text-gray-700 hover:bg-[#FFF4E6] rounded-xl mx-2">
            Mes services
          </a>
          <button (click)="logout()"
                  class="w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-red-50 rounded-xl mx-2">
            Déconnexion
          </button>
        </div>
      </div>
    </ng-container>

  </div>


  <!-- BOUTON BURGER (Mobile) -->
  <button (click)="toggleMenu()" class="md:hidden text-[#FF7A00] focus:outline-none">
    <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none"
      viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round"
        d="M4 6h16M4 12h16M4 18h16" />
    </svg>
  </button>
</nav>


<!-- MENU SLIDE MOBILE -->
<div class="fixed top-0 right-0 h-full w-64 bg-white shadow-xl z-[9998] transform transition-transform duration-300 md:hidden"
     [class.translate-x-full]="!isMenuOpen">

  <div class="p-4 flex justify-end">
    <button (click)="toggleMenu()" class="text-gray-500">✖</button>
  </div>

  <div class="flex pt-7 flex-col gap-4 px-6">

     <!-- ✅ Si connecté -->
    <ng-container *ngIf="auth.user$ | async as user">

<img [src]="user.photoURL || 'assets/icone.png'"
     class="w-10 h-10 rounded-full border object-cover">


      <a routerLink="/mes-services"
         routerLinkActive="text-[#FF7A00]"
         (click)="toggleMenu()"
         class="text-lg font-semibold">
        Mes services
      </a>

      <a routerLink="/messagerie"
         aria-label="Messagerie"
         routerLinkActive="text-[#FF7A00]"
         (click)="toggleMenu()"
         class="text-lg font-semibold flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 7.5A2.5 2.5 0 0 1 5.5 5h13A2.5 2.5 0 0 1 21 7.5v9a2.5 2.5 0 0 1-2.5 2.5h-13A2.5 2.5 0 0 1 3 16.5v-9Z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="m3 8 8.4 6.3a1 1 0 0 0 1.2 0L21 8" />
        </svg>
        <span *ngIf="unreadCount > 0"
              class="ml-1 inline-flex items-center justify-center text-xs font-bold text-white bg-red-500 rounded-full min-w-[1.5rem] px-2 py-0.5 leading-none">
          {{ unreadCount > 10 ? '10+' : unreadCount }}
        </span>
      </a>

      <a routerLink="/services/new" 
         (click)="toggleMenu()"
         class="text-lg font-semibold text-white bg-[#FF7A00] text-center rounded-2xl py-2">
        Publier un service
      </a>

      <a routerLink="/mon-compte" 
         routerLinkActive="text-[#FF7A00]"
         [routerLinkActiveOptions]="{ exact: true }"
         (click)="toggleMenu()" 
         class="text-lg font-semibold">
        Mon compte
      </a>

    <!-- LIENS AVEC COULEUR ACTIVE -->
    <a routerLink="/" 
       routerLinkActive="text-[#FF7A00]" [routerLinkActiveOptions]="{ exact: true }"
       (click)="toggleMenu()" 
       class="text-lg font-semibold">
      Accueil
    </a>

    <a routerLink="/services" 
       routerLinkActive="text-[#FF7A00]" [routerLinkActiveOptions]="{ exact: true }"
       (click)="toggleMenu()" 
       class="text-lg font-semibold">
      Services
    </a>

    <!-- ✅ Si NON connecté -->
    <a *ngIf="!(auth.user$ | async)" 
       routerLink="/login" 
       routerLinkActive="text-[#FF7A00]" [routerLinkActiveOptions]="{ exact: true }"
       (click)="toggleMenu()" 
       class="text-lg font-semibold">
      Se connecter
    </a>

    <a *ngIf="!(auth.user$ | async)" 
       routerLink="/register" 
       routerLinkActive="text-[#FF7A00]" [routerLinkActiveOptions]="{ exact: true }"
       (click)="toggleMenu()" 
       class="text-lg font-semibold">
      S'inscrire
    </a>


          <button (click)="logout()" 
              class="text-left text-red-500 font-semibold">
        Déconnexion
      </button>

   
    </ng-container>

  </div>
</div>

<!-- BACKDROP -->
<div *ngIf="isMenuOpen" (click)="toggleMenu()" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-[9997] md:hidden"></div>
