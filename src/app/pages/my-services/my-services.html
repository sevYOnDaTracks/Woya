<div class="services-page min-h-screen bg-[#FFF7EB] py-10 px-4 md:px-10">
  <div class="max-w-6xl mx-auto space-y-8">

    <div class="glass-card flex items-center justify-between gap-4 flex-wrap">
      <div>
        <p class="hero-eyebrow">Mon espace</p>
        <h1 class="hero-title text-2xl md:text-3xl">Mes services publiés</h1>
        <p class="text-sm text-gray-500">Gère, mets à jour ou supprime tes annonces en toute simplicité.</p>
      </div>
      <button routerLink="/services/new"
              class="primary-btn">
        + Publier un service
      </button>
    </div>

    <div *ngIf="loading" class="glass-card flex flex-col items-center gap-3 text-center">
      <div class="animate-spin h-12 w-12 border-4 border-[#FF7A00] border-t-transparent rounded-full"></div>
      <p class="text-sm text-gray-500">Chargement de tes services…</p>
    </div>

    <section *ngIf="!loading">
      <ng-container *ngIf="services.length > 0; else emptyState">
        <div class="crud-list glass-card">
          <div class="crud-header">
            <span>Service</span>
            <span>Tarif</span>
            <span>Publication</span>
            <span>Actions</span>
          </div>

          <div *ngFor="let service of services; trackBy: trackByService"
               class="crud-row">
            <div>
              <p class="row-title">{{ service.title }}</p>
              <p class="row-meta">{{ service.category }} • {{ service.city }}</p>
              <p class="text-xs mt-1" [class.text-green-600]="service.isActive !== false" [class.text-gray-400]="service.isActive === false">
                {{ service.isActive === false ? 'Masqué' : 'Visible' }}
              </p>
            </div>
            <span class="row-price">
              {{ service.price ? (service.price | number:'1.0-0') + ' FCFA' : '—' }}
            </span>
            <span class="row-date">
              {{ service.createdAt | timeAgo }}
            </span>
            <div class="row-actions">
              <button type="button" class="ghost-btn" (click)="toggleVisibility(service)" [disabled]="togglingId === service.id">
                {{ service.isActive === false ? 'Réactiver' : 'Masquer' }}
              </button>
              <button type="button" class="ghost-btn" (click)="viewService(service)">
                Voir
              </button>
              <button type="button"
                      class="secondary-btn flex items-center justify-center"
                      aria-label="Modifier le service"
                      (click)="editService(service)">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487 19.5 7.125a1.5 1.5 0 0 1 0 2.121l-8.59 8.59a2 2 0 0 1-.894.512l-4.274 1.068a1 1 0 0 1-1.213-1.213l1.068-4.275a2 2 0 0 1 .512-.894l8.59-8.59a1.5 1.5 0 0 1 2.121 0Z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 6l3 3" />
                </svg>
              </button>
              <button type="button"
                      class="danger-btn flex items-center justify-center"
                      [disabled]="deletingId === service.id"
                      aria-label="Supprimer le service"
                      (click)="deleteService(service)">
                <ng-container *ngIf="deletingId === service.id; else trashIcon">
                  <span class="text-xs font-semibold tracking-wide uppercase">Suppression…</span>
                </ng-container>
                <ng-template #trashIcon>
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 7h12" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10 11v6M14 11v6" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 7V5a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M5 7h14l-1 12a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2Z" />
                  </svg>
                </ng-template>
              </button>
            </div>
          </div>
        </div>
      </ng-container>

      <ng-template #emptyState>
        <div class="glass-card text-center">
          <p class="text-lg font-semibold text-[#1A1A1A] mb-2">Tu n’as pas encore publié de service.</p>
          <p class="text-sm text-gray-500 mb-5">Crée ton premier service en quelques clics.</p>
          <button routerLink="/services/new" class="primary-btn">Publier un service</button>
        </div>
      </ng-template>
    </section>

  </div>
</div>
